{"createdAt":"2024-10-27T19:23:26.389Z","updatedAt":"2025-02-13T19:30:03.953Z","id":"ysa3iyCrO6Gf7Fvl","name":"EDP Stop or Start HMG","active":false,"isArchived":false,"nodes":[{"parameters":{"authentication":"privateKey","command":"=PROFILES=(\"CXM-BATMAN\" \"CXM-WOLVERINE\")\n            for PROFILE in \"${PROFILES[@]}\"; do\n                echo \"Definindo todas as tasks de ECS como desejadas para o perfil $PROFILE...\"\n                ecs_clusters=$(aws ecs list-clusters --profile $PROFILE --output json | jq -r '.clusterArns[]')\n                for cluster in $ecs_clusters; do\n                    ecs_services=$(aws ecs list-services --cluster $cluster --profile $PROFILE --output json | jq -r '.serviceArns[]')\n                    for service in $ecs_services; do\n                        aws ecs update-service --cluster $cluster --service $service --desired-count 0 --profile $PROFILE\n                    done\n                done\n                echo \"Todas as tasks de ECS foram definidas como desejadas para o perfil $PROFILE.\"\n                echo \"Interrompendo temporariamente todos os clusters RDS para o perfil $PROFILE...\"\n                rds_clusters=$(aws rds describe-db-clusters --profile $PROFILE --output json | jq -r '.DBClusters[].DBClusterIdentifier')\n                for cluster in $rds_clusters; do\n                    aws rds stop-db-cluster --db-cluster-identifier $cluster --profile $PROFILE\n                done\n                echo \"Todos os clusters RDS foram interrompidos temporariamente para o perfil $PROFILE.\"\n                echo \"Operações concluídas para o perfil $PROFILE.\"\n            done\naws ec2 stop-instances --profile VS-PRD-HML-1 --instance-ids i-051cd7d88364d4ad5 i-020a4c34c2286610e i-0cb4fd7f402e84bfc\n"},"id":"ae2a5009-4dd8-4645-bc11-511c16252c1c","name":"Parar","type":"n8n-nodes-base.ssh","typeVersion":1,"position":[780,500],"credentials":{"sshPrivateKey":{"id":"YoUKXALPqzvnzlxj","name":"EDP-Shell"}}},{"parameters":{"authentication":"privateKey","command":"=PROFILES=(\"CXM-BATMAN\")\n            for PROFILE in \"${PROFILES[@]}\"; do\n                echo \"Iniciando todas as tasks de ECS como desejadas para o perfil $PROFILE...\"\n                ecs_clusters=$(aws ecs list-clusters --profile $PROFILE --output json | jq -r '.clusterArns[]')\n                for cluster in $ecs_clusters; do\n                    ecs_services=$(aws ecs list-services --cluster $cluster --profile $PROFILE --output json | jq -r '.serviceArns[]')\n                    for service in $ecs_services; do\n                        aws ecs update-service --cluster $cluster --service $service --desired-count 1 --profile $PROFILE\n                    done\n                done\n                echo \"Todas as tasks de ECS foram iniciadas como desejadas para o perfil $PROFILE.\"\n                echo \"Iniciando todos os clusters RDS temporariamente para o perfil $PROFILE...\"\n                rds_clusters=$(aws rds describe-db-clusters --profile $PROFILE --output json | jq -r '.DBClusters[].DBClusterIdentifier')\n                for cluster in $rds_clusters; do\n                    aws rds start-db-cluster --db-cluster-identifier $cluster --profile $PROFILE\n                done\n                echo \"Todos os clusters RDS foram iniciados temporariamente para o perfil $PROFILE.\"\n                echo \"Operações concluídas para o perfil $PROFILE.\"\n            done\n"},"id":"7a100324-a61d-4aaa-81f8-c3503d81cb9c","name":"Iniciar","type":"n8n-nodes-base.ssh","typeVersion":1,"position":[780,680],"credentials":{"sshPrivateKey":{"id":"YoUKXALPqzvnzlxj","name":"EDP-Shell"}}},{"parameters":{"rule":{"interval":[{"field":"cronExpression","expression":"0 7 * * 1-5"}]}},"id":"c0d05a3a-5a7e-4bf8-a855-1ba366d4127c","name":"8AM","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[520,680]},{"parameters":{"rule":{"interval":[{"triggerAtHour":20}]}},"id":"63b691dc-51aa-4320-8e56-2236319018f0","name":"7PM","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.1,"position":[520,500],"disabled":true}],"connections":{"8AM":{"main":[[{"node":"Iniciar","type":"main","index":0}]]},"7PM":{"main":[[{"node":"Parar","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":{"node:8AM":{"recurrenceRules":[]},"node:7PM":{"recurrenceRules":[]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"eeb348d9-43ae-489d-a821-96308f55ffbf","triggerCount":1,"tags":[{"createdAt":"2024-10-27T19:35:04.963Z","updatedAt":"2024-10-27T19:35:04.963Z","id":"XGnSXuSd9l0ZeIF7","name":"edp"}]}